# -*- coding: utf-8 -*-
"""
.. module: TODO
    :platform: TODO
    :synopsis: TODO

.. moduleauthor:: Aljosha Friemann a.friemann@automate.wtf
"""

import os
import json

from simple_model import Model, Attribute

from pycli.files import makedirs


class Author(Model):
    name = Attribute(str)
    email = Attribute(str)

class Config(Model):
    author = Attribute(Author)

def load(path):
    if not os.path.exists(path):
        return create(path)

    with open(path, 'rb') as stream:
        config = json.loads(stream.read().decode())

    return config

def create(path):
    if os.path.exists(path):
        raise RuntimeError('Config already exists: {}'.format(path))

    makedirs(os.path.dirname(path))

    config = Config(
        author = Author(
            name = input('Author name: '),
            email = input('Author email: '),
        )
    )

    with open(path, 'rb') as stream:
        stream.write(json.dumps(dict(config)))

    return config

# vim: tabstop=8 expandtab shiftwidth=4 softtabstop=4 fenc=utf-8
